<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cdgit.loan.contractsign.mapper.SubContractSignMapper">

  <resultMap id="BaseResultMap" type="com.cdgit.loan.contractsign.bean.ContractBean">
	<result column="GUARANTY_TYPE" jdbcType="VARCHAR" property="guarantyType" />
	<result column="CONTRACT_AMT" jdbcType="DECIMAL" property="contractAmt" />
	<result column="PRODUCT_TYPE" jdbcType="VARCHAR" property="productType" />
	<result column="MBZJBL" jdbcType="DECIMAL" property="mBzjbl" />
	
	<result column="PARTY_NAME" jdbcType="VARCHAR" property="partyName" />

	<result column="SUBCONTRACT_ID" jdbcType="VARCHAR" property="subcontractId" />
    <result column="SUBCONTRACT_NUM" jdbcType="VARCHAR" property="subcontractNum" />
    <result column="IF_TOP_SUBCON" jdbcType="VARCHAR" property="ifTopSubcon" />
    <result column="SIGN_DATE" jdbcType="TIMESTAMP" property="signDate" />
    <result column="BEGIN_DATE" jdbcType="TIMESTAMP" property="beginDate" />
    <result column="END_DATE" jdbcType="TIMESTAMP" property="endDate" />
    <result column="SUBCONTRACT_AMT" jdbcType="DECIMAL" property="subcontractAmt" />
    <result column="BZ" jdbcType="VARCHAR" property="bz" />
    <result column="ZGBJXE" jdbcType="DECIMAL" property="zgbjxe" />
    <result column="JGGZRBLDJ" jdbcType="DECIMAL" property="jggzrbldj" />
    <result column="PAPER_CON_NUM" jdbcType="VARCHAR" property="paperConNum" />
    <result column="SUB_SCOPE" jdbcType="VARCHAR" property="subScope" />
    <result column="CHANGE_PERCENT" jdbcType="DECIMAL" property="changePercent" />
    <result column="DB_RATE" jdbcType="DECIMAL" property="dbRate" />
    <result column="PROGUARANTY_WAY" jdbcType="VARCHAR" property="proguarantyWay" />
    <result column="PROGUARANTY_TYPE" jdbcType="VARCHAR" property="proguarantyType" />
    <result column="PROGUARANTY_FORM" jdbcType="VARCHAR" property="proguarantyForm" />
    <result column="JRNCRBZJ" jdbcType="DECIMAL" property="jrncrbzj" />
    <result column="BZJBL" jdbcType="DECIMAL" property="bzjbl" />
    <result column="BZJJE" jdbcType="DECIMAL" property="bzjje" />
    <result column="BZJLX" jdbcType="VARCHAR" property="bzjlx" />
    <result column="ANLLJX" jdbcType="DECIMAL" property="anlljx" />
    <result column="QTJSXFS" jdbcType="VARCHAR" property="qtjsxfs" />
    <result column="BZJJXZQ" jdbcType="VARCHAR" property="bzjjxzq" />
    <result column="JRTZKH" jdbcType="DECIMAL" property="jrtzkh" />
    
    <result column="ATTACHED" jdbcType="VARCHAR" property="attached" />
    <result column="ARBITRATE_TYPE" jdbcType="VARCHAR" property="arbitrateType" />
    <result column="ARBITRATE_NAME" jdbcType="VARCHAR" property="arbitrateName" />
    <result column="ARBITRATE_ADDRESS" jdbcType="VARCHAR" property="arbitrateAddress" />
    <result column="A_HOLD_COUNT" jdbcType="DECIMAL" property="aHoldCount" />
    <result column="B_HOLD_COUNT" jdbcType="DECIMAL" property="bHoldCount" />
    <result column="C_HOLD_COUNT" jdbcType="DECIMAL" property="cHoldCount" />
    <result column="TOTAL_COUNT" jdbcType="DECIMAL" property="totalCount" />
    <result column="ADD_CLAUSE" jdbcType="VARCHAR" property="addClause" />
    <result column="D_HOLD_COUNT" jdbcType="DECIMAL" property="dHoldCount" />
    <result column="E_HOLD_COUNT" jdbcType="DECIMAL" property="eHoldCount" />
    <result column="C_NAME" jdbcType="VARCHAR" property="cName" />
    <result column="LEGAL_COURT" jdbcType="VARCHAR" property="legalCourt" />
    
    <result column="UUID" jdbcType="VARCHAR" property="uuid" />
    <result column="A_SEND_ADDR" jdbcType="VARCHAR" property="aSendAddr" />
    <result column="A_POSTCODE" jdbcType="VARCHAR" property="aPostcode" />
    <result column="A_RECEIVER" jdbcType="VARCHAR" property="aReceiver" />
    <result column="A_PHONE" jdbcType="VARCHAR" property="aPhone" />
    <result column="A_EMAIL" jdbcType="VARCHAR" property="aEmail" />
    <result column="A_OTHER" jdbcType="VARCHAR" property="aOther" />
    <result column="B_SEND_ADDR" jdbcType="VARCHAR" property="bSendAddr" />
    <result column="B_POSTCODE" jdbcType="VARCHAR" property="bPostcode" />
    <result column="B_RECEIVER" jdbcType="VARCHAR" property="bReceiver" />
    <result column="B_PHONE" jdbcType="VARCHAR" property="bPhone" />
    <result column="B_EMAIL" jdbcType="VARCHAR" property="bEmail" />
    <result column="C_SEND_ADDR" jdbcType="VARCHAR" property="cSendAddr" />
    <result column="C_POSTCODE" jdbcType="VARCHAR" property="cPostcode" />
    <result column="C_RECEIVER" jdbcType="VARCHAR" property="cReceiver" />
    <result column="C_PHONE" jdbcType="VARCHAR" property="cPhone" />
    <result column="C_EMAIL" jdbcType="VARCHAR" property="cEmail" />
    <result column="D_SEND_ADDR" jdbcType="VARCHAR" property="dSendAddr" />
    <result column="D_POSTCODE" jdbcType="VARCHAR" property="dPostcode" />
    <result column="D_RECEIVER" jdbcType="VARCHAR" property="dReceiver" />
    <result column="D_PHONE" jdbcType="VARCHAR" property="dPhone" />
    <result column="D_EMAIL" jdbcType="VARCHAR" property="dEmail" />
    
    <result column="CON_SUBCON_ID" jdbcType="VARCHAR" property="conSubconId" />
  </resultMap>
    <select id="selSubGrtBzj" resultType="java.util.Map">
  	select  m.SURETY_ID,m.MARGIN_SORT,m.MARGIN_ACCOUNT,m.OPEN_BANK,m.ACCT_NAME,m.CURRENCY_CD,m.ACC_BALANCE,to_char(m.END_DATE,'yyyy-mm-dd') as END_DATE,m.IS_JIXI,m.MARGIN_RATE
	    from TB_GRT_COLLATERAL t,TB_BIZ_GRT_REL ta,tb_csm_party tb,TB_GRT_MARGIN m
		where t.guaranty_id=ta.SURETY_ID
		and t.customer_num=tb.party_id
	    and m.SURETY_ID=t.guaranty_id
		and t.customer_num =(select con_party_id from TB_CON_SUBCONTRACT where SUBCONTRACT_ID =#{subcontractId} )
		and ta.APPLY_ID =#{applyId}
		and ta.SURETY_TYPE=#{subcontractType}
    </select>
    <select id="getConSubBzj" resultType="java.util.Map">
    			select  ta.RELATION_ID,m.SURETY_ID,m.MARGIN_SORT,m.OPEN_BANK,M.MARGIN_ACCOUNT,
				m.ACCT_NAME,m.CURRENCY_CD,m.ACC_BALANCE,m.surety_key_id,
				to_char(m.BEGIN_DATE,'yyyy-mm-dd') as BEGIN_DATE,
				to_char(m.END_DATE,'yyyy-mm-dd') as END_DATE,
				m.IS_JIXI,
				m.MARGIN_RATE,
				m.APPEND_FLAG,
				m.APPEND_AMT
            from TB_CON_SUBCONTRACT t,TB_CON_SUB_GRT_REL ta,
            TB_CSM_PARTY tc,tb_grt_margin m
			where t.SUBCONTRACT_ID=ta.SUBCONTRACT_ID
			and t.PARTY_ID=tc.PARTY_ID
            and m.SURETY_ID=ta.SURETY_ID
			and t.SUBCONTRACT_ID=#{subcontractId}
    
    </select>
  <select id="getConBZJList" resultType="java.util.Map">
  		   select tc.RELATION_ID,ta.CON_SUBCON_ID,t.SUBCONTRACT_ID,t.SUBCONTRACT_NUM,p.PARTY_NAME,t.BZ,t.SUBCONTRACT_AMT,t.BZJJE,ta.operation_type
		    from TB_CON_SUBCONTRACT t,TB_CON_SUBCONTRACT_REL ta,TB_CSM_PARTY p,TB_BIZ_SUBCONTRACT_REL tc
		    where t.SUBCONTRACT_ID=ta.SUBCONTRACT_ID
		    and p.PARTY_ID=t.PARTY_ID
		    and tc.SUBCONTRACT_ID=t.SUBCONTRACT_ID
            and t.SUBCONTRACT_STATUS in('01','02','03','05')
		    and t.SUBCONTRACT_TYPE=#{subcontractType}
		    and ta.CONTRACT_ID=#{contractId}
  </select>
      <select id="selSubGrtBzr" resultType="java.util.Map">
			select t.surety_id,
			   t.party_id,
		       tb.party_name,
		       tb.cert_num,
		       tb.cert_type,
		       t.currency_cd,
		       t.surety_amt,
		       (t.surety_amt - t.usable_guarantee_limit)as used_amt
		  from tb_grt_guarantee_basic t, tb_biz_grt_rel ta, v_csm_party tb
		 where t.surety_id = ta.surety_id
		   and t.party_id = tb.party_id
			and t.PARTY_ID not in (select te.PARTY_ID from TB_CON_SUBCONTRACT_REL td,tb_con_contract_info te where td.CONTRACT_ID=te.CONTRACT_ID and td.SUBCONTRACT_ID =#{subcontractId}
                                union
                                select te.PARTY_ID from TB_CON_SUBCONTRACT_REL td,tb_con_credit_info te where td.CONTRACT_ID=te.CONTRACT_ID and td.SUBCONTRACT_ID =#{subcontractId})
			and ta.APPLY_ID =#{applyId}
			and ta.SURETY_TYPE=#{subcontractType}
			<!--and t.IF_TOP_AMT = (select IF_TOP_SUBCON from TB_CON_SUBCONTRACT where SUBCONTRACT_ID =#subcontractId# )-->
  </select>
  
  
      <!--获取 保证合同 下关联 保证人信息-->
    <!-- 移植数据显示不同字段 -->
    <select id="getConSubBzr" resultType="java.util.Map">
						 select ta.surety_id,
			        tb.relation_id,
			        tc.subcontract_type,
			        td.party_name,
			        td.party_id,
			        td.party_type_cd,
			        td.cert_num,
			        td.cert_type,
			        case when te.if_data_move = '1' then tb.surety_amt else ta.surety_amt end as total_amt,
			        (ta.surety_amt - ta.usable_guarantee_limit) as used_amt,
			        decode(tc.if_top_subcon, '1', tb.surety_amt, te.rmb_amt) as surety_amt
			   from tb_grt_guarantee_basic ta,
			        tb_con_sub_grt_rel     tb,
			        tb_con_subcontract     tc,
			        tb_con_subcontract_rel td,
			        tb_con_contract_info   te,
			        v_csm_party            td
			  where ta.surety_id = tb.surety_id
			    and tb.subcontract_id = tc.subcontract_id
			    and ta.party_id = td.party_id
			    and tc.subcontract_id = td.subcontract_id
			    and td.contract_id = te.contract_id
			    and te.con_status != '06'
			   	and tb.SUBCONTRACT_ID=#{subcontractId}
			   	<if test="contractId != null and contractId !='' ">
		       	 and te.CONTRACT_ID=#{contractId}
		      	</if>	
  </select>
    <!--获取 综合授信 下关联 保证人信息-->
    <!-- 移植数据显示不同字段 -->
    <select id="getCreditSubBzr" resultType="java.util.Map">
			select ta.surety_id,
              tb.relation_id,
              tc.subcontract_type,
              td.party_name,
              td.party_id,
              td.party_type_cd,
              td.cert_num,
              td.cert_type,
              case when tc.if_data_move = '1' then tb.surety_amt else ta.surety_amt end as total_amt,
              (ta.surety_amt - ta.usable_guarantee_limit) as used_amt,
              tb.surety_amt as surety_amt
         from tb_grt_guarantee_basic ta,
              tb_con_sub_grt_rel     tb,
              tb_con_subcontract     tc,
              tb_con_subcontract_rel tf,
              tb_con_credit_info   te,
              v_csm_party  td                       
        where ta.surety_id = tb.surety_id
          and tb.subcontract_id = tc.subcontract_id
         and ta.party_id = td.party_id
          and tc.subcontract_id = tf.subcontract_id
          and tf.contract_id = te.contract_id       
          and te.con_status != '06'
          and tb.SUBCONTRACT_ID=#subcontractId#
			   	<if test="contractId != null and contractId'' ">
		       	 and te.CONTRACT_ID=#{contractId}
		      	</if>	
  </select>
  
  <select id="getApproveInfo" resultType="java.util.Map">
  			select te.APPROVE_ID,te.APPLY_ID 
			from TB_CON_SUBCONTRACT t,
			TB_CON_SUBCONTRACT_REL ta,
			tb_con_contract_info tb,
			tb_biz_amount_detail_approve tc,
			tb_biz_amount_approve td,
			tb_biz_approve te
			where t.SUBCONTRACT_ID=ta.SUBCONTRACT_ID
			and ta.CONTRACT_ID=tb.CONTRACT_ID
			and tb.AMOUNT_DETAIL_ID =tc.AMOUNT_DETAIL_ID
			and tc.AMOUNT_ID=td.AMOUNT_ID
			and td.APPROVE_ID=te.APPROVE_ID
			and t.SUBCONTRACT_ID=#{subcontractId}
  	
  </select>
  <select id="getConBzrList" resultType="java.util.Map">
  			select * from (
		      select ta.SUBCONTRACT_NUM,ta.IF_TOP_SUBCON,
             	decode(ta.IF_TOP_SUBCON,'1',ta.ZGBJXE,'0',info.CONTRACT_AMT,'0') SUBCONTRACT_AMT,
             	decode(ta.IF_TOP_SUBCON,'1',tb.SURETY_AMT,'0',info.CONTRACT_AMT,'0') SURETY_AMT,
                tb.CON_SUBCON_ID,t.RELATION_ID,ta.SUBCONTRACT_ID,ta.BZ,tb.OPERATION_TYPE
                from TB_CON_SUBCONTRACT ta
                inner join TB_CON_SUBCONTRACT_REL tb on ta.SUBCONTRACT_ID = tb.SUBCONTRACT_ID and (tb.if_effective='1' or tb.if_effective is null)
                inner join TB_BIZ_SUBCONTRACT_REL t on t.SUBCONTRACT_ID = ta.SUBCONTRACT_ID
                left join TB_CON_CONTRACT_INFO info on tb.CONTRACT_ID=info.CONTRACT_ID
                where ta.SUBCONTRACT_TYPE='04'
                and ta.SUBCONTRACT_STATUS in('01','02','03','05')
		        and tb.CONTRACT_ID=#{contractId}
		)th left join (
		    select listagg(tx.PARTY_NAME,',') within group(order by PARTY_NAME) as PARTY_NAME,ty.SUBCONTRACT_ID  
		        from TB_GRT_GUARANTEE_BASIC tz,TB_CON_SUB_GRT_REL ty,TB_CSM_PARTY tx,TB_CON_SUBCONTRACT_REL tw
		        where tz.SURETY_ID=ty.SURETY_ID
		        and tz.PARTY_ID=tx.PARTY_ID
		        and ty.SUBCONTRACT_ID=tw.SUBCONTRACT_ID
		        and tw.CONTRACT_ID=#{contractId}
		        group by ty.SUBCONTRACT_ID
		) ti 
		on th.SUBCONTRACT_ID=ti.SUBCONTRACT_ID
  
  </select>
  
  
  <!--查询一个主合同只能绑定一种抵质押品类型  -->
  	<select id="selectContractOnlyOneMpType" resultType="java.util.Map">
  		SELECT * FROM  TB_CON_SUBCONTRACT_REL T1 
		,TB_CON_SUBCONTRACT T2 ,TB_CON_CONTRACT_INFO T3 ,TB_CON_SUB_GRT_REL T4
		WHERE T3.CONTRACT_ID=T1.CONTRACT_ID AND T1.SUBCONTRACT_ID=T2.SUBCONTRACT_ID
		AND T4.SUBCONTRACT_ID=T2.SUBCONTRACT_ID
		AND T3.CONTRACT_ID=#{contractId} AND T4.SURETY_ID=#{suretyId}
  	</select>
  	<select id="selectSubGrtRelBySuretyIdAndSubId" resultType="java.util.Map">
  		select * from TB_CON_SUB_GRT_REL where	SURETY_ID=#{suretyId} and SUBCONTRACT_ID=#{subcontractId}
  	</select>
  	<select id="selectConSubGrtRelBySubcontractId" resultType="java.util.Map">
  		select * from TB_CON_SUB_GRT_REL where SUBCONTRACT_ID=#{subcontractId}
  	</select>
	<delete id="deleteConSuncontractRelById">
		delete from TB_CON_SUBCONTRACT_REL where CON_SUBCON_ID=#{conSubconId}
	</delete>
	<delete id="deleteSubcontractById">
		delete from TB_CON_SUBCONTRACT where SUBCONTRACT_ID=#{subcontractId}
	</delete>
	<delete id="deleteConNoticeAddrsBySubcontractId">
		delete from TB_CON_NOTICE_ADDRS where CONTRACT_ID=#{subcontractId}
	</delete>
	<delete id="deleteConAttachedInfoBySubcontractId">
		delete from TB_CON_ATTACHED_INFO where CONTRACT_ID=#{subcontractId}
	</delete>
	<select id="selectBizGrtRelBySuretyIdAndApplyId" resultType="java.util.Map">
		SELECT t1.MORTGAGE_VALUE,
		t2.SET_GUARANTY_AMT
		 FROM TB_BIZ_GRT_REL t1 
		LEFT JOIN TB_GRT_COLLATERAL t2 ON t1.SURETY_ID=t2.GUARANTY_ID
		where	t1.APPLY_ID=#{applyId} AND t1.SURETY_ID=#{suretyId}
	</select>
	<select id="selectSubContractBySubcontractId" resultMap="BaseResultMap">
		select SUBCONTRACT_ID,IF_TOP_SUBCON,ZGBJXE FROM TB_CON_SUBCONTRACT WHERE SUBCONTRACT_ID=#{subcontractId}
	</select>
	<select id="selSubGrt" resultType="java.util.Map">
		SELECT 
		t1.RELATION_ID,
		t2.GUARANTY_ID, 
		t3.PARTY_NAME,
		t2.COLLATERAL_NUM,
		t2.COLLATERAL_TYPE_CD,
		t2.CURRENCY_CD,
		t2.MARKET_VALUE,
		(t2.SET_GUARANTY_AMT-DECODE(t5.GRT_AMT,null,t1.MORTGAGE_VALUE,0)) SET_GUARANTY_AMT,
		(t2.MARKET_VALUE-(t2.SET_GUARANTY_AMT-DECODE(t5.GRT_AMT,null,t1.MORTGAGE_VALUE,0))) ABLE_VALUE,
		t1.MORTGAGE_VALUE APPLY_MORTGAGE_VALUE,
		t2.COLLATERAL_STATUS_CD,
		t3.PARTY_ID
		FROM TB_BIZ_GRT_REL t1 
		LEFT JOIN TB_GRT_COLLATERAL t2 ON t1.SURETY_ID=t2.GUARANTY_ID
		LEFT JOIN (select PARTY_ID from TB_CON_SUBCONTRACT where SUBCONTRACT_ID =#{subcontractId}) t4 ON t4.PARTY_ID=t2.CUSTOMER_NUM
		LEFT JOIN V_CSM_PARTY t3 ON t3.PARTY_ID=t4.PARTY_ID
		LEFT JOIN TB_CON_SUB_GRT_REL t5 ON t5.SURETY_ID=t1.SURETY_ID
		LEFT JOIN TB_CON_SUBCONTRACT t6 ON t5.SUBCONTRACT_id=t6.SUBCONTRACT_id
		WHERE t1.APPLY_ID=#{applyId} AND t2.COLLATERAL_STATUS_CD!='06'
		AND t1.SURETY_TYPE=#{subcontractType}
		AND t4.PARTY_ID=#{partyId}
	</select>
	
	    <!--获取 担保合同 对应的押品信息 -->
    <select id="getConSub" resultType="java.util.Map">
		SELECT 
		t4.PARTY_NAME,
		t3.COLLATERAL_NUM,
		t3.COLLATERAL_TYPE_CD,
		t3.CURRENCY_CD,
		t3.EVAL_VALUE,
		t3.MARKET_VALUE,
		t3.SET_GUARANTY_AMT,
		t1.SURETY_AMT,
		t1.RELATION_ID,
		t2.SUBCONTRACT_ID,
		t1.SURETY_ID,
		t1.GRT_AMT
		 from TB_CON_SUB_GRT_REL t1
		LEFT JOIN TB_CON_SUBCONTRACT t2 ON t1.SUBCONTRACT_ID=t2.SUBCONTRACT_ID
		LEFT JOIN TB_GRT_COLLATERAL t3 ON t1.SURETY_ID=t3.GUARANTY_ID
		LEFT JOIN V_CSM_PARTY t4 ON t4.PARTY_ID=t3.CUSTOMER_NUM
		where t2.SUBCONTRACT_ID=#{subcontractId}
		<if test="subcontractType != null and subcontractType!='' ">
       	 and t2.SUBCONTRACT_TYPE=#{subcontractType}
      	</if>	
		<if test="subcontractNum != null and subcontractNum!='' ">
       	 and t2.SUBCONTRACT_NUM=#{subcontractNum}
      	</if>			
    </select>
	<select id="selectGrtConInfoBySubcontractId" resultMap="BaseResultMap">
		SELECT    t1.SUBCONTRACT_ID,
			t7.CON_SUBCON_ID,
		    t1.SUBCONTRACT_NUM,
		    t1.IF_TOP_SUBCON,
		    t1.SIGN_DATE,
		    t1.BEGIN_DATE,
		    t1.END_DATE,        
		    t1.SUBCONTRACT_AMT,
		    t1.BZ,              
		    t1.ZGBJXE,           
		    t1.JGGZRBLDJ,        
		    t1.PAPER_CON_NUM,    
		    t1.SUB_SCOPE,
		    t1.CHANGE_PERCENT,
		    t1.DB_RATE,
    		t1.PROGUARANTY_WAY,
    		t1.PROGUARANTY_TYPE,
    		t1.PROGUARANTY_FORM,
    		t1.JRNCRBZJ,
    		t1.BZJBL,
    		t1.BZJJE,
    		t1.BZJLX,
    		t1.ANLLJX,
    		t1.QTJSXFS,
    		t1.BZJJXZQ,
    		t1.JRTZKH,
		    t4.UUID,
		   t4.A_SEND_ADDR,
		   t4.A_POSTCODE,
		   t4.A_RECEIVER,
		   t4.A_PHONE,
		   t4.A_EMAIL,
		   t4.A_OTHER,
		   t4.B_SEND_ADDR,
		   t4.B_POSTCODE,
		   t4.B_RECEIVER,
		   t4.B_PHONE,
		   t4.B_EMAIL,
		   t4.C_SEND_ADDR,
		   t4.C_POSTCODE,
		   t4.C_RECEIVER,
		   t4.C_PHONE,
		   t4.C_EMAIL,
		   t4.D_SEND_ADDR,
		   t4.D_POSTCODE,
		   t4.D_RECEIVER,
		   t4.D_PHONE,
		   t4.D_EMAIL,    
		   t5.ATTACHED,
		    t5.ARBITRATE_TYPE,
		    t5.ARBITRATE_NAME,
		    t5.ARBITRATE_ADDRESS,
		    t5.A_HOLD_COUNT,
		    t5.B_HOLD_COUNT,
		    t5.C_HOLD_COUNT,
		    t5.TOTAL_COUNT,
		    t5.ADD_CLAUSE,
		    t5.D_HOLD_COUNT,
		    t5.E_HOLD_COUNT,
		    t5.C_NAME,
    		t5.LEGAL_COURT,
    		t6.PARTY_NAME,
    		t8.GUARANTY_TYPE,
    		t8.CONTRACT_AMT,
    		t8.PRODUCT_TYPE,
    		t8.bzjbl mbzjbl
    		FROM TB_CON_SUBCONTRACT t1 
			LEFT JOIN TB_CON_NOTICE_ADDRS t4 ON t4.CONTRACT_ID=t1.SUBCONTRACT_ID
			LEFT JOIN TB_CON_ATTACHED_INFO t5 ON t5.CONTRACT_ID=t1.SUBCONTRACT_ID
			LEFT JOIN V_CSM_PARTY t6 ON t1.PARTY_ID=t6.PARTY_ID
			LEFT JOIN TB_CON_SUBCONTRACT_REL t7 ON t7.SUBCONTRACT_ID=t1.SUBCONTRACT_ID
			LEFT JOIN TB_CON_CONTRACT_INFO t8 ON t7.CONTRACT_ID=t8.CONTRACT_ID
			WHERE t1.SUBCONTRACT_ID=#{subcontractId} and t7.CONTRACT_ID=#{contractId}
	</select>

  <!-- 获取合同下关联的抵质押合同信息-->
    <select id="getConDyList" resultType="java.util.Map">
			    select ta.bz,
           tc.party_name,
           ta.subcontract_num,
           ta.if_top_subcon,
           decode(ta.if_top_subcon,'1',ta.zgbjxe,ta.subcontract_amt)as subcontract_amt,
           decode(ta.if_top_subcon,'1',tb.surety_amt,ta.subcontract_amt)as surety_amt,
           tb.con_subcon_id,
           t.relation_id,
           ta.subcontract_id,
           tb.operation_type,
           ta.party_id
      from tb_biz_subcontract_rel t,
           tb_con_subcontract     ta,
           tb_con_subcontract_rel tb,
           tb_csm_party           tc
          <!-- tb_con_contract_info td -->
     where t.subcontract_id = ta.subcontract_id
       and ta.subcontract_id = tb.subcontract_id
       and ta.party_id = tc.party_id
       and (tb.if_effective='1'  or tb.if_effective is null)
        <!--and td.contract_id=tb.contract_id -->
        <!-- modi by shanmf:增加状态04的显示 20170921 -->
       and ta.subcontract_status in ('01', '02', '03', '05','04')  
		and ta.SUBCONTRACT_TYPE=#{subcontractType}
		<if test="applyId != null and applyId!='' ">
       	 and t.APPLY_ID = #{applyId}
      	</if>
		<if test="contractId != null and contractId!='' ">
       	 and tb.CONTRACT_ID=#{contractId}
      	</if>
    </select>
    
        <!--抵押合同页面选择抵质人信息 -->
    <select id="selectParty" resultType="java.util.Map">
		select ta.PARTY_ID,ta.CERT_TYPE,ta.CERT_NUM,ta.PARTY_NAME,t.SURETY_TYPE
			from TB_BIZ_GRT_REL t,v_csm_party ta,TB_GRT_COLLATERAL tb 
			where t.APPLY_ID=#{applyId}
			and t.SURETY_TYPE =#{subcontractType}
			and t.SURETY_ID=tb.GUARANTY_ID
			and tb.CUSTOMER_NUM=ta.PARTY_ID
			and tb.COLLATERAL_STATUS_CD!='06'
			group by ta.PARTY_ID,ta.PARTY_NAME,ta.CERT_NUM,ta.CERT_TYPE,t.SURETY_TYPE
    </select>
    
    <insert id="insertConSubcontractSelective" parameterType="com.cdgit.loan.contractsign.bean.ConSubcontract">
    insert into CRMS.TB_CON_SUBCONTRACT
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="subcontractId != null">
        SUBCONTRACT_ID,
      </if>
      <if test="subcontractNum != null">
        SUBCONTRACT_NUM,
      </if>
      <if test="subcontractManualNum != null">
        SUBCONTRACT_MANUAL_NUM,
      </if>
      <if test="subcontractType != null">
        SUBCONTRACT_TYPE,
      </if>
      <if test="subcontractStatus != null">
        SUBCONTRACT_STATUS,
      </if>
      <if test="ifTopSubcon != null">
        IF_TOP_SUBCON,
      </if>
      <if test="signDate != null">
        SIGN_DATE,
      </if>
      <if test="beginDate != null">
        BEGIN_DATE,
      </if>
      <if test="endDate != null">
        END_DATE,
      </if>
      <if test="subcontractAmt != null">
        SUBCONTRACT_AMT,
      </if>
      <if test="userNum != null">
        USER_NUM,
      </if>
      <if test="orgNum != null">
        ORG_NUM,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="updateTime != null">
        UPDATE_TIME,
      </if>
      <if test="partyId != null">
        PARTY_ID,
      </if>
      <if test="bz != null">
        BZ,
      </if>
      <if test="zgbjxe != null">
        ZGBJXE,
      </if>
      <if test="jggzrbldj != null">
        JGGZRBLDJ,
      </if>
      <if test="zfwyjbl != null">
        ZFWYJBL,
      </if>
      <if test="changePercent != null">
        CHANGE_PERCENT,
      </if>
      <if test="jrncrbzj != null">
        JRNCRBZJ,
      </if>
      <if test="bzjje != null">
        BZJJE,
      </if>
      <if test="bzjbl != null">
        BZJBL,
      </if>
      <if test="bzjlx != null">
        BZJLX,
      </if>
      <if test="aylljx != null">
        AYLLJX,
      </if>
      <if test="anlljx != null">
        ANLLJX,
      </if>
      <if test="jrtzkh != null">
        JRTZKH,
      </if>
      <if test="aviAmt != null">
        AVI_AMT,
      </if>
      <if test="totalAmt != null">
        TOTAL_AMT,
      </if>
      <if test="paperConNum != null">
        PAPER_CON_NUM,
      </if>
      <if test="bzjjxzq != null">
        BZJJXZQ,
      </if>
      <if test="conPartyId != null">
        CON_PARTY_ID,
      </if>
      <if test="ifDataMove != null">
        IF_DATA_MOVE,
      </if>
      <if test="qtjsxfs != null">
        QTJSXFS,
      </if>
      <if test="proguarantyWay != null">
        PROGUARANTY_WAY,
      </if>
      <if test="proguarantyType != null">
        PROGUARANTY_TYPE,
      </if>
      <if test="proguarantyForm != null">
        PROGUARANTY_FORM,
      </if>
      <if test="subScope != null">
        SUB_SCOPE,
      </if>
      <if test="dbRate != null">
        DB_RATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="subcontractId != null">
        #{subcontractId,jdbcType=VARCHAR},
      </if>
      <if test="subcontractNum != null">
        #{subcontractNum,jdbcType=VARCHAR},
      </if>
      <if test="subcontractManualNum != null">
        #{subcontractManualNum,jdbcType=VARCHAR},
      </if>
      <if test="subcontractType != null">
        #{subcontractType,jdbcType=VARCHAR},
      </if>
      <if test="subcontractStatus != null">
        #{subcontractStatus,jdbcType=VARCHAR},
      </if>
      <if test="ifTopSubcon != null">
        #{ifTopSubcon,jdbcType=VARCHAR},
      </if>
      <if test="signDate != null">
        #{signDate,jdbcType=TIMESTAMP},
      </if>
      <if test="beginDate != null">
        #{beginDate,jdbcType=TIMESTAMP},
      </if>
      <if test="endDate != null">
        #{endDate,jdbcType=TIMESTAMP},
      </if>
      <if test="subcontractAmt != null">
        #{subcontractAmt,jdbcType=DECIMAL},
      </if>
      <if test="userNum != null">
        #{userNum,jdbcType=VARCHAR},
      </if>
      <if test="orgNum != null">
        #{orgNum,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="partyId != null">
        #{partyId,jdbcType=VARCHAR},
      </if>
      <if test="bz != null">
        #{bz,jdbcType=VARCHAR},
      </if>
      <if test="zgbjxe != null">
        #{zgbjxe,jdbcType=DECIMAL},
      </if>
      <if test="jggzrbldj != null">
        #{jggzrbldj,jdbcType=DECIMAL},
      </if>
      <if test="zfwyjbl != null">
        #{zfwyjbl,jdbcType=DECIMAL},
      </if>
      <if test="changePercent != null">
        #{changePercent,jdbcType=DECIMAL},
      </if>
      <if test="jrncrbzj != null">
        #{jrncrbzj,jdbcType=DECIMAL},
      </if>
      <if test="bzjje != null">
        #{bzjje,jdbcType=DECIMAL},
      </if>
      <if test="bzjbl != null">
        #{bzjbl,jdbcType=DECIMAL},
      </if>
      <if test="bzjlx != null">
        #{bzjlx,jdbcType=VARCHAR},
      </if>
      <if test="aylljx != null">
        #{aylljx,jdbcType=DECIMAL},
      </if>
      <if test="anlljx != null">
        #{anlljx,jdbcType=DECIMAL},
      </if>
      <if test="jrtzkh != null">
        #{jrtzkh,jdbcType=DECIMAL},
      </if>
      <if test="aviAmt != null">
        #{aviAmt,jdbcType=DECIMAL},
      </if>
      <if test="totalAmt != null">
        #{totalAmt,jdbcType=DECIMAL},
      </if>
      <if test="paperConNum != null">
        #{paperConNum,jdbcType=VARCHAR},
      </if>
      <if test="bzjjxzq != null">
        #{bzjjxzq,jdbcType=VARCHAR},
      </if>
      <if test="conPartyId != null">
        #{conPartyId,jdbcType=VARCHAR},
      </if>
      <if test="ifDataMove != null">
        #{ifDataMove,jdbcType=VARCHAR},
      </if>
      <if test="qtjsxfs != null">
        #{qtjsxfs,jdbcType=VARCHAR},
      </if>
      <if test="proguarantyWay != null">
        #{proguarantyWay,jdbcType=VARCHAR},
      </if>
      <if test="proguarantyType != null">
        #{proguarantyType,jdbcType=VARCHAR},
      </if>
      <if test="proguarantyForm != null">
        #{proguarantyForm,jdbcType=VARCHAR},
      </if>
      <if test="subScope != null">
        #{subScope,jdbcType=VARCHAR},
      </if>
      <if test="dbRate != null">
        #{dbRate,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  <update id="updateConSubcontractSelective" parameterType="com.cdgit.loan.contractsign.bean.ConSubcontract">
    update CRMS.TB_CON_SUBCONTRACT
    <set>
      <if test="subcontractNum != null">
        SUBCONTRACT_NUM = #{subcontractNum,jdbcType=VARCHAR},
      </if>
      <if test="subcontractManualNum != null">
        SUBCONTRACT_MANUAL_NUM = #{subcontractManualNum,jdbcType=VARCHAR},
      </if>
      <if test="subcontractType != null">
        SUBCONTRACT_TYPE = #{subcontractType,jdbcType=VARCHAR},
      </if>
      <if test="subcontractStatus != null">
        SUBCONTRACT_STATUS = #{subcontractStatus,jdbcType=VARCHAR},
      </if>
      <if test="ifTopSubcon != null">
        IF_TOP_SUBCON = #{ifTopSubcon,jdbcType=VARCHAR},
      </if>
      <if test="signDate != null">
        SIGN_DATE = #{signDate,jdbcType=TIMESTAMP},
      </if>
      <if test="beginDate != null">
        BEGIN_DATE = #{beginDate,jdbcType=TIMESTAMP},
      </if>
      <if test="endDate != null">
        END_DATE = #{endDate,jdbcType=TIMESTAMP},
      </if>
      <if test="subcontractAmt != null">
        SUBCONTRACT_AMT = #{subcontractAmt,jdbcType=DECIMAL},
      </if>
      <if test="userNum != null">
        USER_NUM = #{userNum,jdbcType=VARCHAR},
      </if>
      <if test="orgNum != null">
        ORG_NUM = #{orgNum,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="partyId != null">
        PARTY_ID = #{partyId,jdbcType=VARCHAR},
      </if>
      <if test="bz != null">
        BZ = #{bz,jdbcType=VARCHAR},
      </if>
      <if test="zgbjxe != null">
        ZGBJXE = #{zgbjxe,jdbcType=DECIMAL},
      </if>
      <if test="jggzrbldj != null">
        JGGZRBLDJ = #{jggzrbldj,jdbcType=DECIMAL},
      </if>
      <if test="zfwyjbl != null">
        ZFWYJBL = #{zfwyjbl,jdbcType=DECIMAL},
      </if>
      <if test="changePercent != null">
        CHANGE_PERCENT = #{changePercent,jdbcType=DECIMAL},
      </if>
      <if test="jrncrbzj != null">
        JRNCRBZJ = #{jrncrbzj,jdbcType=DECIMAL},
      </if>
      <if test="bzjje != null">
        BZJJE = #{bzjje,jdbcType=DECIMAL},
      </if>
      <if test="bzjbl != null">
        BZJBL = #{bzjbl,jdbcType=DECIMAL},
      </if>
      <if test="bzjlx != null">
        BZJLX = #{bzjlx,jdbcType=VARCHAR},
      </if>
      <if test="aylljx != null">
        AYLLJX = #{aylljx,jdbcType=DECIMAL},
      </if>
      <if test="anlljx != null">
        ANLLJX = #{anlljx,jdbcType=DECIMAL},
      </if>
      <if test="jrtzkh != null">
        JRTZKH = #{jrtzkh,jdbcType=DECIMAL},
      </if>
      <if test="aviAmt != null">
        AVI_AMT = #{aviAmt,jdbcType=DECIMAL},
      </if>
      <if test="totalAmt != null">
        TOTAL_AMT = #{totalAmt,jdbcType=DECIMAL},
      </if>
      <if test="paperConNum != null">
        PAPER_CON_NUM = #{paperConNum,jdbcType=VARCHAR},
      </if>
      <if test="bzjjxzq != null">
        BZJJXZQ = #{bzjjxzq,jdbcType=VARCHAR},
      </if>
      <if test="conPartyId != null">
        CON_PARTY_ID = #{conPartyId,jdbcType=VARCHAR},
      </if>
      <if test="ifDataMove != null">
        IF_DATA_MOVE = #{ifDataMove,jdbcType=VARCHAR},
      </if>
      <if test="qtjsxfs != null">
        QTJSXFS = #{qtjsxfs,jdbcType=VARCHAR},
      </if>
      <if test="proguarantyWay != null">
        PROGUARANTY_WAY = #{proguarantyWay,jdbcType=VARCHAR},
      </if>
      <if test="proguarantyType != null">
        PROGUARANTY_TYPE = #{proguarantyType,jdbcType=VARCHAR},
      </if>
      <if test="proguarantyForm != null">
        PROGUARANTY_FORM = #{proguarantyForm,jdbcType=VARCHAR},
      </if>
      <if test="subScope != null">
        SUB_SCOPE = #{subScope,jdbcType=VARCHAR},
      </if>
      <if test="dbRate != null">
        DB_RATE = #{dbRate,jdbcType=DECIMAL},
      </if>
    </set>
    where SUBCONTRACT_ID = #{subcontractId,jdbcType=VARCHAR}
  </update>
    <insert id="insertConNoticeAddrsSelective" parameterType="com.cdgit.loan.contractsign.bean.ConAttachedInfo">
    insert into CRMS.TB_CON_NOTICE_ADDRS
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="uuid != null">
        UUID,
      </if>
      <if test="contractId != null">
        CONTRACT_ID,
      </if>
      <if test="aSendAddr != null">
        A_SEND_ADDR,
      </if>
      <if test="aPostcode != null">
        A_POSTCODE,
      </if>
      <if test="aReceiver != null">
        A_RECEIVER,
      </if>
      <if test="aPhone != null">
        A_PHONE,
      </if>
      <if test="aEmail != null">
        A_EMAIL,
      </if>
      <if test="aOther != null">
        A_OTHER,
      </if>
      <if test="bSendAddr != null">
        B_SEND_ADDR,
      </if>
      <if test="bPostcode != null">
        B_POSTCODE,
      </if>
      <if test="bReceiver != null">
        B_RECEIVER,
      </if>
      <if test="bPhone != null">
        B_PHONE,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="updateTime != null">
        UPDATE_TIME,
      </if>
      <if test="bEmail != null">
        B_EMAIL,
      </if>
      <if test="cSendAddr != null">
        C_SEND_ADDR,
      </if>
      <if test="cPostcode != null">
        C_POSTCODE,
      </if>
      <if test="cReceiver != null">
        C_RECEIVER,
      </if>
      <if test="cPhone != null">
        C_PHONE,
      </if>
      <if test="cEmail != null">
        C_EMAIL,
      </if>
      <if test="cOther != null">
        C_OTHER,
      </if>
      <if test="dSendAddr != null">
        D_SEND_ADDR,
      </if>
      <if test="dPostcode != null">
        D_POSTCODE,
      </if>
      <if test="dReceiver != null">
        D_RECEIVER,
      </if>
      <if test="dPhone != null">
        D_PHONE,
      </if>
      <if test="dEmail != null">
        D_EMAIL,
      </if>
      <if test="dOther != null">
        D_OTHER,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="uuid != null">
        #{uuid,jdbcType=VARCHAR},
      </if>
      <if test="contractId != null">
        #{contractId,jdbcType=VARCHAR},
      </if>
      <if test="aSendAddr != null">
        #{aSendAddr,jdbcType=VARCHAR},
      </if>
      <if test="aPostcode != null">
        #{aPostcode,jdbcType=VARCHAR},
      </if>
      <if test="aReceiver != null">
        #{aReceiver,jdbcType=VARCHAR},
      </if>
      <if test="aPhone != null">
        #{aPhone,jdbcType=VARCHAR},
      </if>
      <if test="aEmail != null">
        #{aEmail,jdbcType=VARCHAR},
      </if>
      <if test="aOther != null">
        #{aOther,jdbcType=VARCHAR},
      </if>
      <if test="bSendAddr != null">
        #{bSendAddr,jdbcType=VARCHAR},
      </if>
      <if test="bPostcode != null">
        #{bPostcode,jdbcType=VARCHAR},
      </if>
      <if test="bReceiver != null">
        #{bReceiver,jdbcType=VARCHAR},
      </if>
      <if test="bPhone != null">
        #{bPhone,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="bEmail != null">
        #{bEmail,jdbcType=VARCHAR},
      </if>
      <if test="cSendAddr != null">
        #{cSendAddr,jdbcType=VARCHAR},
      </if>
      <if test="cPostcode != null">
        #{cPostcode,jdbcType=VARCHAR},
      </if>
      <if test="cReceiver != null">
        #{cReceiver,jdbcType=VARCHAR},
      </if>
      <if test="cPhone != null">
        #{cPhone,jdbcType=VARCHAR},
      </if>
      <if test="cEmail != null">
        #{cEmail,jdbcType=VARCHAR},
      </if>
      <if test="cOther != null">
        #{cOther,jdbcType=VARCHAR},
      </if>
      <if test="dSendAddr != null">
        #{dSendAddr,jdbcType=VARCHAR},
      </if>
      <if test="dPostcode != null">
        #{dPostcode,jdbcType=VARCHAR},
      </if>
      <if test="dReceiver != null">
        #{dReceiver,jdbcType=VARCHAR},
      </if>
      <if test="dPhone != null">
        #{dPhone,jdbcType=VARCHAR},
      </if>
      <if test="dEmail != null">
        #{dEmail,jdbcType=VARCHAR},
      </if>
      <if test="dOther != null">
        #{dOther,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateConNoticeAddrsSelective" parameterType="com.cdgit.loan.contractsign.bean.ConAttachedInfo">
    update CRMS.TB_CON_NOTICE_ADDRS
    <set>
      <if test="contractId != null">
        CONTRACT_ID = #{contractId,jdbcType=VARCHAR},
      </if>
      <if test="aSendAddr != null">
        A_SEND_ADDR = #{aSendAddr,jdbcType=VARCHAR},
      </if>
      <if test="aPostcode != null">
        A_POSTCODE = #{aPostcode,jdbcType=VARCHAR},
      </if>
      <if test="aReceiver != null">
        A_RECEIVER = #{aReceiver,jdbcType=VARCHAR},
      </if>
      <if test="aPhone != null">
        A_PHONE = #{aPhone,jdbcType=VARCHAR},
      </if>
      <if test="aEmail != null">
        A_EMAIL = #{aEmail,jdbcType=VARCHAR},
      </if>
      <if test="aOther != null">
        A_OTHER = #{aOther,jdbcType=VARCHAR},
      </if>
      <if test="bSendAddr != null">
        B_SEND_ADDR = #{bSendAddr,jdbcType=VARCHAR},
      </if>
      <if test="bPostcode != null">
        B_POSTCODE = #{bPostcode,jdbcType=VARCHAR},
      </if>
      <if test="bReceiver != null">
        B_RECEIVER = #{bReceiver,jdbcType=VARCHAR},
      </if>
      <if test="bPhone != null">
        B_PHONE = #{bPhone,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="bEmail != null">
        B_EMAIL = #{bEmail,jdbcType=VARCHAR},
      </if>
      <if test="cSendAddr != null">
        C_SEND_ADDR = #{cSendAddr,jdbcType=VARCHAR},
      </if>
      <if test="cPostcode != null">
        C_POSTCODE = #{cPostcode,jdbcType=VARCHAR},
      </if>
      <if test="cReceiver != null">
        C_RECEIVER = #{cReceiver,jdbcType=VARCHAR},
      </if>
      <if test="cPhone != null">
        C_PHONE = #{cPhone,jdbcType=VARCHAR},
      </if>
      <if test="cEmail != null">
        C_EMAIL = #{cEmail,jdbcType=VARCHAR},
      </if>
      <if test="cOther != null">
        C_OTHER = #{cOther,jdbcType=VARCHAR},
      </if>
      <if test="dSendAddr != null">
        D_SEND_ADDR = #{dSendAddr,jdbcType=VARCHAR},
      </if>
      <if test="dPostcode != null">
        D_POSTCODE = #{dPostcode,jdbcType=VARCHAR},
      </if>
      <if test="dReceiver != null">
        D_RECEIVER = #{dReceiver,jdbcType=VARCHAR},
      </if>
      <if test="dPhone != null">
        D_PHONE = #{dPhone,jdbcType=VARCHAR},
      </if>
      <if test="dEmail != null">
        D_EMAIL = #{dEmail,jdbcType=VARCHAR},
      </if>
      <if test="dOther != null">
        D_OTHER = #{dOther,jdbcType=VARCHAR},
      </if>
    </set>
    where UUID = #{uuid,jdbcType=VARCHAR}
  </update>
    <insert id="insertConAttachedInfoSelective" parameterType="com.cdgit.loan.contractsign.bean.ConAttachedInfo">
    insert into CRMS.TB_CON_ATTACHED_INFO
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="attached != null">
        ATTACHED,
      </if>
      <if test="contractId != null">
        CONTRACT_ID,
      </if>
      <if test="arbitrateType != null">
        ARBITRATE_TYPE,
      </if>
      <if test="arbitrateName != null">
        ARBITRATE_NAME,
      </if>
      <if test="arbitrateAddress != null">
        ARBITRATE_ADDRESS,
      </if>
      <if test="other != null">
        OTHER,
      </if>
      <if test="aHoldCount != null">
        A_HOLD_COUNT,
      </if>
      <if test="bHoldCount != null">
        B_HOLD_COUNT,
      </if>
      <if test="cType != null">
        C_TYPE,
      </if>
      <if test="cHoldCount != null">
        C_HOLD_COUNT,
      </if>
      <if test="totalCount != null">
        TOTAL_COUNT,
      </if>
      <if test="addClause != null">
        ADD_CLAUSE,
      </if>
      <if test="constraintIndex != null">
        CONSTRAINT_INDEX,
      </if>
      <if test="dHoldCount != null">
        D_HOLD_COUNT,
      </if>
      <if test="eHoldCount != null">
        E_HOLD_COUNT,
      </if>
      <if test="tkCondition != null">
        TK_CONDITION,
      </if>
      <if test="cName != null">
        C_NAME,
      </if>
      <if test="legalCourt != null">
        LEGAL_COURT,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="attached != null">
        #{attached,jdbcType=VARCHAR},
      </if>
      <if test="contractId != null">
        #{contractId,jdbcType=VARCHAR},
      </if>
      <if test="arbitrateType != null">
        #{arbitrateType,jdbcType=VARCHAR},
      </if>
      <if test="arbitrateName != null">
        #{arbitrateName,jdbcType=VARCHAR},
      </if>
      <if test="arbitrateAddress != null">
        #{arbitrateAddress,jdbcType=VARCHAR},
      </if>
      <if test="other != null">
        #{other,jdbcType=VARCHAR},
      </if>
      <if test="aHoldCount != null">
        #{aHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="bHoldCount != null">
        #{bHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="cType != null">
        #{cType,jdbcType=VARCHAR},
      </if>
      <if test="cHoldCount != null">
        #{cHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="totalCount != null">
        #{totalCount,jdbcType=DECIMAL},
      </if>
      <if test="addClause != null">
        #{addClause,jdbcType=VARCHAR},
      </if>
      <if test="constraintIndex != null">
        #{constraintIndex,jdbcType=VARCHAR},
      </if>
      <if test="dHoldCount != null">
        #{dHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="eHoldCount != null">
        #{eHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="tkCondition != null">
        #{tkCondition,jdbcType=VARCHAR},
      </if>
      <if test="cName != null">
        #{cName,jdbcType=VARCHAR},
      </if>
      <if test="legalCourt != null">
        #{legalCourt,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateConAttachedInfoSelective" parameterType="com.cdgit.loan.contractsign.bean.ConAttachedInfo">
    update CRMS.TB_CON_ATTACHED_INFO
    <set>
      <if test="contractId != null">
        CONTRACT_ID = #{contractId,jdbcType=VARCHAR},
      </if>
      <if test="arbitrateType != null">
        ARBITRATE_TYPE = #{arbitrateType,jdbcType=VARCHAR},
      </if>
      <if test="arbitrateName != null">
        ARBITRATE_NAME = #{arbitrateName,jdbcType=VARCHAR},
      </if>
      <if test="arbitrateAddress != null">
        ARBITRATE_ADDRESS = #{arbitrateAddress,jdbcType=VARCHAR},
      </if>
      <if test="other != null">
        OTHER = #{other,jdbcType=VARCHAR},
      </if>
      <if test="aHoldCount != null">
        A_HOLD_COUNT = #{aHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="bHoldCount != null">
        B_HOLD_COUNT = #{bHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="cType != null">
        C_TYPE = #{cType,jdbcType=VARCHAR},
      </if>
      <if test="cHoldCount != null">
        C_HOLD_COUNT = #{cHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="totalCount != null">
        TOTAL_COUNT = #{totalCount,jdbcType=DECIMAL},
      </if>
      <if test="addClause != null">
        ADD_CLAUSE = #{addClause,jdbcType=VARCHAR},
      </if>
      <if test="constraintIndex != null">
        CONSTRAINT_INDEX = #{constraintIndex,jdbcType=VARCHAR},
      </if>
      <if test="dHoldCount != null">
        D_HOLD_COUNT = #{dHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="eHoldCount != null">
        E_HOLD_COUNT = #{eHoldCount,jdbcType=DECIMAL},
      </if>
      <if test="tkCondition != null">
        TK_CONDITION = #{tkCondition,jdbcType=VARCHAR},
      </if>
      <if test="cName != null">
        C_NAME = #{cName,jdbcType=VARCHAR},
      </if>
      <if test="legalCourt != null">
        LEGAL_COURT = #{legalCourt,jdbcType=VARCHAR},
      </if>
    </set>
    where ATTACHED = #{attached,jdbcType=VARCHAR}
  </update>
</mapper>